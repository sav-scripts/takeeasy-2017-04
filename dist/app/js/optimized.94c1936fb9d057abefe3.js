!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){var b="waitForImages";a.waitForImages={hasImageProperties:["backgroundImage","listStyleImage","borderImage","borderCornerImage","cursor"],hasImageAttributes:["srcset"]},a.expr[":"]["has-src"]=function(b){return a(b).is('img[src][src!=""]')},a.expr[":"].uncached=function(b){return!!a(b).is(":has-src")&&!b.complete},a.fn.waitForImages=function(){var c,d,e,f=0,g=0,h=a.Deferred();if(a.isPlainObject(arguments[0])?(e=arguments[0].waitForAll,d=arguments[0].each,c=arguments[0].finished):1===arguments.length&&"boolean"===a.type(arguments[0])?e=arguments[0]:(c=arguments[0],d=arguments[1],e=arguments[2]),c=c||a.noop,d=d||a.noop,e=!!e,!a.isFunction(c)||!a.isFunction(d))throw new TypeError("An invalid callback was supplied.");return this.each(function(){var i=a(this),j=[],k=a.waitForImages.hasImageProperties||[],l=a.waitForImages.hasImageAttributes||[],m=/url\(\s*(['"]?)(.*?)\1\s*\)/g;e?i.find("*").addBack().each(function(){var b=a(this);b.is("img:has-src")&&j.push({src:b.attr("src"),element:b[0]}),a.each(k,function(a,c){var d,e=b.css(c);if(!e)return!0;for(;d=m.exec(e);)j.push({src:d[2],element:b[0]})}),a.each(l,function(c,d){var e,f=b.attr(d);return!f||(e=f.split(","),void a.each(e,function(c,d){d=a.trim(d).split(" ")[0],j.push({src:d,element:b[0]})}))})}):i.find("img:has-src").each(function(){j.push({src:this.src,element:this})}),f=j.length,g=0,0===f&&(c.call(i[0]),h.resolveWith(i[0])),a.each(j,function(e,j){var k=new Image,l="load."+b+" error."+b;a(k).one(l,function b(e){var k=[g,f,"load"==e.type];return g++,d.apply(j.element,k),h.notifyWith(j.element,k),a(this).off(l,b),g==f?(c.call(i[0]),h.resolveWith(i[0]),!1):void 0}),k.src=j.src})}),h.promise()}}),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120==0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a.removeData(this,"mousewheel-page-height")},getLineHeight:function(b){var c=a(b),d=c["offsetParent"in a.fn?"offsetParent":"parent"]();return d.length||(d=a("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}),function(){"use strict";function a(a,b,c,d,e){function f(b){b&&(m.content.height=$(q.content).height()),$(q.container).css("width","100%").css("height",m.container.height),n.height=m.content.height-m.container.height,n.height<0&&(n.height=0),n.top>n.height&&(n.top=n.height);var c=e?0:30,d=e?0:60;return p.enabled?(m.scrollContainer.x=null==p.x?m.container.width:p.x,m.scrollContainer.y=null==p.y?c:p.y+c,m.scrollContainer.width=null==p.width?l.scrollContainerWidth:p.width,m.scrollContainer.height=null==p.height?m.container.height-d:p.height-d):(m.scrollContainer.x=m.container.width,m.scrollContainer.y=c,m.scrollContainer.width=l.scrollContainerWidth,m.scrollContainer.height=m.container.height-d),q.scrollbar.innerHTML=null!=p.barInnerHtml?p.barInnerHtml:"",q.scrollbase.innerHTML=null!=p.baseInnerHtml?p.baseInnerHtml:"",o.scrollDividContent=m.scrollContainer.height/m.container.height,m.scrollbar.height=k?m.scrollbar.height:m.container.height/m.content.height*m.scrollContainer.height,n.topForScroll=n.top*o.scrollDividContent,n.heightForScroll=m.scrollContainer.height-m.scrollbar.height,n.height<=0?$(q.scrollContainer).css("display","none"):$(q.scrollContainer).css("display","block"),o.mouseWheelInterval=500/n.height*.1,o.buttonProgress=.3*o.mouseWheelInterval,$(q.scrollContainer).css("left",m.scrollContainer.x).css("top",m.scrollContainer.y).css("width",m.scrollContainer.width).css("height",m.scrollContainer.height),$(q.scrollbase).css("height",m.scrollContainer.height),k||$(q.scrollbar).css("height",m.scrollbar.height),$(q.scrollbarContainer).css("height",m.scrollbar.height),$(a).css("overflow","visible"),i(),a}function g(){var b=0;if(d){var c=new Hammer(q.container);c.on("panstart",function(a){a.preventDefault(),b=0}),c.on("panmove",function(a){a.preventDefault();var c=a.deltaY-b;b=a.deltaY,h(n.tProgress-c/n.height)});var e=new Hammer(q.scrollbarContainer);e.on("panstart",function(a){a.preventDefault(),b=0}),e.on("panmove",function(a){a.preventDefault();var c=-(a.deltaY-b);b=a.deltaY,h(n.tProgress-c/n.heightForScroll)})}else j(q.container,function(a){h(n.tProgress-a/n.height)}),j(q.scrollbarContainer,function(a){h(n.tProgress+a/n.heightForScroll)});$(q.scrollbarContainer).bind("mouseover",function(a){$(q.scrollbar).toggleClass("hover",!0)}),$(q.scrollbarContainer).bind("mouseout",function(a){$(q.scrollbar).toggleClass("hover",!1)}),$(document).bind("mousewheel",function(b,c){if($.contains(document,a)){b.stopPropagation();var d=c<0?o.mouseWheelInterval:-o.mouseWheelInterval;h(n.tProgress+d)}})}function h(a){var b=!1;return a<=0&&(a=0,b=!0),a>=1&&(a=1,b=!0),o.smoothMoving?(n.tProgress=a,TweenLite.to(n,.4,{progress:a,onUpdate:i})):(n.tPprogress=n.progress=a,i()),b}function i(){n.top=n.height*n.progress,n.topForScroll=n.heightForScroll*n.tProgress,$(q.scrollbarContainer).css("top",n.topForScroll),$(q.content).css("top",-n.top)}function j(a,b){var c=!1;$(a).on("mousedown",function(a){function d(a){$(document).unbind("mouseup",d),$(document).unbind("mousemove",e)}function e(a){var c=a.clientY-f;f=a.clientY,b.call(null,c)}var f=a.clientY;c=!0,$(document).on("mouseup",d),$(document).on("mousemove",e)})}var k=!1;null==e&&(e=!0);var l={scrollContainerWidth:50},m={content:{x:0,y:0,width:0,height:0},container:{x:0,y:0,width:0,height:0},scrollContainer:{x:0,y:0,width:30,height:0},scrollbase:{x:0,y:0,width:0,height:0},scrollbar:{x:0,y:0,width:0,height:0}};null!=c&&(k=!0,m.scrollbar.height=c);var n={top:0,height:0,topForScroll:0,heightForScroll:0,progress:0,tProgress:0},o={scrollDividContent:1,mouseWheelInterval:.1,smoothMoving:!0,buttonInterval:30,buttonProgress:.02},p={enabled:!1,x:0,y:0,width:0,height:0,barInnerHtml:null,baseInnerHtml:null},q={content:null,container:null,scrollContainer:null,scrollbase:null,scrollbarContainer:null,scrollbar:null,btnUp:null,btnDown:null};return m.container.width=$(a).width(),m.container.height=$(a).height(),q.container=document.createElement("div"),q.container.className="ss_container",q.content=document.createElement("div"),q.content.className="ss_content",q.container.appendChild(q.content),q.content.innerHTML=a.innerHTML,a.innerHTML="",a.appendChild(q.container),null==b&&(b=$(q.content).height()),m.content.height=b,q.scrollContainer=document.createElement("div"),q.scrollContainer.className="ss_scroll_container",a.appendChild(q.scrollContainer),q.scrollbase=document.createElement("div"),q.scrollbase.className="ss_scrollbase",q.scrollContainer.appendChild(q.scrollbase),q.scrollbarContainer=document.createElement("div"),q.scrollbarContainer.className="ss_scrollbar_container",q.scrollContainer.appendChild(q.scrollbarContainer),q.scrollbar=document.createElement("div"),q.scrollbar.className="ss_scrollbar",q.scrollbarContainer.appendChild(q.scrollbar),e||(q.btnUp=document.createElement("div"),q.btnUp.className="ss_button_up",q.scrollContainer.appendChild(q.btnUp),q.btnDown=document.createElement("div"),q.btnDown.className="ss_button_down",q.scrollContainer.appendChild(q.btnDown)),a.containerSize=function(b,c){return null!=b&&(m.container.width=b),null!=c&&(m.container.height=c),a},a.contentHeight=function(b){return m.content.height=b,a},a.scrollbarInnerHtml=function(b){return p.barInnerHtml=b,a},a.scrollbaseInnerHtml=function(b){return p.baseInnerHtml=b,a},a.scrollbarHeight=function(b){return m.scrollbar.height=b,a},a.scrollBound=function(b,c,d,e){return p.enabled=!0,p.x=b,p.y=c,p.width=d,p.height=e,a},a.update=f,a.updateProgress=h,a.doms=q,g(),a}window.SimpleScroller=a}(),function(){function a(a){console.log("statusChangeCallback"),console.log(a),"connected"===a.status?console.log("connected"):"not_authorized"===a.status?console.log("not authorized"):console.log("not login")}function b(a){for(var b=atob(a.split(",")[1]),c=new ArrayBuffer(b.length),d=new Uint8Array(c),e=0;e<b.length;e++)d[e]=b.charCodeAt(e);return new Blob([c],{type:"image/png"})}function c(a,b,c){this.api=a,this.apiParams=b,this.after=null,this.dataList=[],this.thereIsMore=!0,this.cbFetchComplete=c,this.lastFetchIndex=0}var d,e=window.FBHelper={},f=["public_profile"];e.uid=null,e.uname=null,e.init=function(b,c,e,f){"string"==typeof b&&(b={appId:b,cookie:!0,xfbml:!0,version:"v2.8"}),d=b.appId,window.fbAsyncInit=function(){FB.init(b),f&&FB.getLoginStatus(function(b){a(b)}),c&&c.apply()},function(a,b,c){var d,f=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//connect.facebook.net/zh_TW/sdk.js",f.parentNode.insertBefore(d,f),d.onerror=e)}(document,"script","facebook-jssdk")},e.login=function(a,b,c){a||(a=f),FB.login(function(a){a.authResponse?(e.uid=a.authResponse.userID,"connected"==a.status?null!=b&&b.apply(null,[a]):null!=c&&c.apply(null,[{action:"login",response:a,type:a.status,message:"not connected"}])):null!=c&&c.apply(null,[{action:"login",response:a,type:a.status,message:"user cancel login"}])},{scope:a})},e.getPublicProfile=function(a){FB.api("/me",function(b){e.uname=b.name,a.apply(null,[b])})},e.checkLoginStatus=function(a,b){function c(c){for(var d={},e=a.length,f=0,g=0;g<a.length;g++)d[a[g]]=!1;FB.api("/me/permissions",function(a){if(a&&a.data&&a.data.length){var g,h;for(g=0;g<a.data.length;g++)h=a.data[g],void 0!==d[h.permission]&&(d[h.permission]=!0,f++);f<e?b.call(null,{message:"lack permission",permissionDic:d},null):b.call(null,null,c)}else b.call(null,{message:"check permission fail"},null)})}FB.getLoginStatus(function(d){"connected"===d.status?a?c(d.authResponse):b.call(null,null,d.authResponse):b.call(null,{message:"no connect"},null)})},e.postImageToFacebook=function(a,c,d){var e,f=a.toDataURL("image/png");try{e=b(f)}catch(a){console.log(a)}var g=new FormData;g.append("access_token",c),g.append("source",e);try{$.ajax({url:"https://graph.facebook.com/me/photos?access_token="+c,type:"POST",data:g,processData:!1,contentType:!1,cache:!1,success:function(a){d.call(null,null,a)},error:function(a,b,c){d.call(null,"error "+c+" Status "+a.status)},complete:function(){}})}catch(a){d.call(null,a)}},window.FBData=c,c.prototype.fetch=function(){var a=this;return a.thereIsMore||(console.log("warning: trying to fetch data where there is no more."),a.cbFetchComplete.call(a,a.dataList)),a.lastFetchIndex=a.dataList.length,FB.api(a.api,"GET",a.apiParams,function(b){b.error?console.error(b.error):(a.dataList=a.dataList.concat(b.data),a.apiParams.after=Boolean(b.paging&&b.paging.next)?b.paging.cursors.after:null,a.apiParams.after?a.thereIsMore=!0:(delete a.apiParams.after,a.thereIsMore=!1),a.cbFetchComplete.call(a,a.dataList))}),this}}(),function(){"use strict";function a(a){var b=parseInt(a);return isNaN(b)&&(b=0),b}var b=window.Helper={};b.getSize_cover=function(a,b,c,d){var e,f,g=a/b,h=c/d;h>g?(f=b,e=f*h):(e=a,f=e/h);var i=e/c,j=a/i,k=b/i;return{width:e,height:f,ratio:i,contentCenterBound:{x:.5*(c-j),y:.5*(d-k),width:j,height:k}}},b.getSize_contain=function(a,b,c,d){var e,f,g=a/b,h=c/d;return h>g?(e=a,f=e/h):(f=b,e=f*h),{width:e,height:f,ratio:e/c}},Helper.extract=function(a,b,c,d){null==d&&(d=0),null==b&&(b=document);var e=$(b).find(a).get(d);return e||console.error("can't find dom, selector: "+a+", source: "+b),Helper.getInitValue(e),null!=c&&c.appendChild(e),e},Helper.$extract=function(a,b,c,d){null==d&&(d=0),null==b&&(b=document);var e=$(b).find(a).get(d);return e||console.error("can't find dom, selector: "+a+", source: "+b),Helper.getInitValue(e),null!=c&&c.appendChild(e),$(e)},Helper.pxToPercent=function(b,c,d,e,f){function g(b,c,d){null==d&&(d=100);var e=Helper.styleDic[b];e||(e=b);var g=a(i.css(e)),h=g/c*d+"%";f?f[b]=h:0!=g&&i.css(e,h)}e||(e={w:!0,h:!1,l:!0,t:!1,r:!0,b:!1});var h,i=$(b);for(h in e){g(h,1==e[h]?c:d)}},Helper.clearStyles=function(a){$(a).removeAttr("style")},Helper.getInitValue=function(b,c,d,e,f,g){b.init||(b.init={}),b.geom||(b.geom={}),f&&Helper.clearStyles(b);var h,i;if(g?(h=b.init[g]={},i=b.geom[g]={}):(h=b.init,i=b.geom),c||(b.currentStyle?(i.w=h.w=a(b.currentStyle.width),i.h=h.h=a(b.currentStyle.height),i.ml=h.ml=a(b.currentStyle.marginLeft),i.mt=h.mt=a(b.currentStyle.marginTop),i.mr=h.mr=a(b.currentStyle.marginRight),i.mb=h.mb=a(b.currentStyle.marginBottom),i.t=h.t=a(b.currentStyle.top),i.l=h.l=a(b.currentStyle.left),i.r=h.r=a(b.currentStyle.right),i.b=h.b=a(b.currentStyle.bottom)):(i.w=h.w=$(b).width(),i.h=h.h=$(b).height(),i.ml=h.ml=a($(b).css("margin-left")),i.mt=h.mt=a($(b).css("margin-top")),i.mr=h.mr=a($(b).css("margin-right")),i.mb=h.mb=a($(b).css("margin-bottom")),i.t=h.t=a($(b).css("top")),i.l=h.l=a($(b).css("left")),i.r=h.r=a($(b).css("right")),i.b=h.b=a($(b).css("bottom")))),i.scale=h.scale=1,d)for(var j=0;j<d.length;j++){var k=d[j];h[k]=i[k]=a($(b).css(k))}if(e){var l,m,n;l=e.width,m=e.height,n=e.styleDic,Helper.pxToPercent(b,l,m,n,h)}},Helper.styleDic={l:"left",r:"right",t:"top",b:"bottom",ml:"margin-left",mr:"margin-right",mt:"margin-top",mb:"margin-bottom",w:"width",h:"height"},Helper.applyTransform=function(a,b,c,d,e,f){var g,h;f?(g=a.init[f],h=a.geom[f]):(g=a.init,h=a.geom);var i,j,k,l,m=null!=b?g.scale*b:g.scale,n=$(a);if(c)for(j=c.length,i=0;i<j;i++)k=c[i],l=Helper.styleDic[k],l||(l=k),h[k]=g[k]*m,n.css(l,h[k]+"px");if(d)for(j=d.length,i=0;i<j;i++)k=d[i],l=Helper.styleDic[k],h[k]=g[k]*m,n.css(l,h[k]+"%");if(e)for(j=e.length,i=0;i<j;i++)k=e[i],l=Helper.styleDic[k],l||(l=k),n.css(l,g[k])},Helper.transformDom=function(a,b,c,d,e){var f=null!=b?a.init.scale*b:a.init.scale;0!=e&&(e===!0?(a.geom.w=a.init.w*f,a.geom.h=a.init.h*f,$(a).css("width",a.geom.w).css("height",a.geom.h)):(c.l&&(a.geom.l=a.init.l*f,$(a).css("left",a.geom.l)),c.t&&(a.geom.t=a.init.t*f,$(a).css("top",a.geom.t)))),0!=c&&(c===!0?(a.geom.t=a.init.t*f,a.geom.l=a.init.l*f,$(a).css("top",a.geom.t).css("left",a.geom.l)):(c.l&&(a.geom.l=a.init.l*f,$(a).css("left",a.geom.l)),c.t&&(a.geom.t=a.init.t*f,$(a).css("top",a.geom.t)),c.r&&(a.geom.r=a.init.r*f,$(a).css("right",a.geom.r)),c.b&&(a.geom.b=a.init.b*f,$(a).css("bottom",a.geom.b)))),0!=d&&(d===!0?(a.geom.mt=a.init.mt*f,a.geom.ml=a.init.ml*f,$(a).css("margin-top",a.geom.mt).css("margin-left",a.geom.ml)):(c.ml&&(a.geom.ml=a.init.ml*f,$(a).css("margin-left",a.geom.ml)),c.mt&&(a.geom.mt=a.init.mt*f,$(a).css("margin-top",a.geom.mt)),c.mr&&(a.geom.mr=a.init.mr*f,$(a).css("margin-right",a.geom.mr)),c.mb&&(a.geom.mb=a.init.mb*f,$(a).css("margin-bottom",a.geom.mb))))},Helper.downScaleImage=function(a,b,c,d,e,f){var g=document.createElement("canvas");return g.width=a.width,g.height=a.height,g.getContext("2d").drawImage(a,0,0),Helper.downScaleCanvas(g,b,c,d,e,f)},Helper.downScaleCanvas=function(a,b,c,d,e,f){if(c||(c=0),d||(d=0),!(b<1&&b>0))throw"scale must be a positive number <1 ";var g=b*b,h=a.width,i=a.height,j=Math.floor(h*b),k=Math.floor(i*b),l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=!1,B=!1,C=a.getContext("2d").getImageData(0,0,h,i).data,D=new Float32Array(3*j*k),E=0,F=0,G=0;for(m=0;m<i;m++)for(p=m*b,t=0|p,q=3*t*j,B=t!=(0|p+b),B&&(y=t+1-p,z=p+b-t-1),l=0;l<h;l++,n+=4)o=l*b,s=0|o,r=q+3*s,A=s!=(0|o+b),A&&(w=s+1-o,x=o+b-s-1),E=C[n],F=C[n+1],G=C[n+2],A||B?A&&!B?(u=w*b,D[r]+=E*u,D[r+1]+=F*u,D[r+2]+=G*u,v=x*b,D[r+3]+=E*v,D[r+4]+=F*v,D[r+5]+=G*v):B&&!A?(u=y*b,D[r]+=E*u,D[r+1]+=F*u,D[r+2]+=G*u,v=z*b,D[r+3*j]+=E*v,D[r+3*j+1]+=F*v,D[r+3*j+2]+=G*v):(u=w*y,D[r]+=E*u,D[r+1]+=F*u,D[r+2]+=G*u,v=x*y,D[r+3]+=E*v,D[r+4]+=F*v,D[r+5]+=G*v,v=w*z,D[r+3*j]+=E*v,D[r+3*j+1]+=F*v,D[r+3*j+2]+=G*v,v=x*z,D[r+3*j+3]+=E*v,D[r+3*j+4]+=F*v,D[r+3*j+5]+=G*v):(D[r]+=E*g,D[r+1]+=F*g,D[r+2]+=G*g);var H=document.createElement("canvas");H.width=e||j,H.height=f||k;var I=H.getContext("2d"),J=I.getImageData(0,0,j,k),K=J.data,L=0;for(n=0,r=0;L<j*k;n+=3,r+=4,L++)K[r]=Math.ceil(D[n]),K[r+1]=Math.ceil(D[n+1]),K[r+2]=Math.ceil(D[n+2]),K[r+3]=255;return I.putImageData(J,c,d),H},Helper.imageToCanvas=function(a,b,c){var d=document.createElement("canvas"),e=1,f=b,g=c;d.width=f,d.height=g;var h=d.getContext("2d"),i=Helper.getSize_cover(f,g,a.width,a.height),j=.5*(f-i.width),k=.5*(g-i.height);return i.ratio<1?($(d).detach(),d=Helper.downScaleImage(a,i.ratio,j,k,f,g)):h.drawImage(a,0,0,a.width,a.height,j,k,i.width*e,i.height),d},Helper.getContextBoundingBox=function(a,b){void 0===b&&(b=15);var c,d,e,f,g,h,i=a.canvas.width,j=a.canvas.height,k=a.getImageData(0,0,i,j).data;a:for(d=j;d--;)for(c=i;c--;)if(k[4*(i*d+c)+3]>b){h=d;break a}if(h){a:for(c=i;c--;)for(d=h+1;d--;)if(k[4*(i*d+c)+3]>b){g=c;break a}a:for(c=0;c<=g;++c)for(d=h+1;d--;)if(k[4*(i*d+c)+3]>b){e=c;break a}a:for(d=0;d<=h;++d)for(c=e;c<=g;++c)if(k[4*(i*d+c)+3]>b){f=d;break a}return{x:e,y:f,maxX:g,maxY:h,w:g-e,h:h-f}}},Helper.precentPullToRefresh=function(){var a=function(a){function b(b){a=b.touches[0].clientY}function c(b){var c=b.touches[0].clientY,d=c-a;return a=c,d>0}a=a||0;var d=!1;return{touchstartHandler:function(a){1==a.touches.length&&(b(a),d=0===window.pageYOffset)},touchmoveHandler:function(a){if(d&&(d=!1,c(a)))return void a.preventDefault()}}}();document.addEventListener("touchstart",a.touchstartHandler),document.addEventListener("touchmove",a.touchmoveHandler)},Helper.changeQueryParam=function(a,b,c){var d=new RegExp("([?&])"+b+"=.*?(&|$)","i"),e=a.indexOf("?")!==-1?"&":"?";return a.match(d)?a.replace(d,"$1"+b+"="+c+"$2"):a+e+b+"="+c},Helper.removeURLParameter=function(a,b){var c=a.split("?");if(c.length>=2){for(var d=encodeURIComponent(b)+"=",e=c[1].split(/[&;]/g),f=e.length;f-- >0;)e[f].lastIndexOf(d,0)!==-1&&e.splice(f,1);return a=c[0]+(e.length>0?"?"+e.join("&"):"")}return a},Helper.getParameterByName=function(a,b){b||(b=window.location.href),a=a.replace(/[\[\]]/g,"\\$&");var c=new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)"),d=c.exec(b);return d?d[2]?decodeURIComponent(d[2].replace(/\+/g," ")):"":null},Helper.selectIntoArray=function(a,b,c,d){function e(b){var e=a.find(b);return e.length>0&&c.push(e[0]),d&&(d[b]=e),e}if(b.constructor!==Array)return e(b);for(var f=0;f<b.length;f++)e(b[f])},Helper.clearElementsStyles=function(a,b){if(b){var c;for(c=0;c<b.length;c++)a.css(b[c],"")}else a.attr("style","")}}(),function(){var a=(window.Utility={},{}),b={};b.log="log",b.warn="warn",b.error="error",b.debug="debug",b.info="info",Utility.setConsoleMethod=function(b,c){console[b]=1==c?a[b]:function(){}},Utility.disableAllConsoleMethods=function(){for(var a in b)this.setConsoleMethod(a,!1)},Utility.enableAllConsoleMethods=function(){for(var a in b)this.setConsoleMethod(a,!0)},function(){if(!window.console){window.console={};for(var c in b)console[b[c]]=function(){}}for(var c in b)a[b[c]]=console[b[c]];window.Array.prototype.indexOf||(window.Array.prototype.indexOf=function(a){var b=this.length>>>0,c=Number(arguments[1])||0;for(c=c<0?Math.ceil(c):Math.floor(c),c<0&&(c+=b);c<b;c++)if(c in this&&this[c]===a)return c;return-1})}();var c={};Utility.analyzeURL=function(a){if(!c[a]){var b=/^((http[s]?|ftp):\/)?\/?([^:\/\s]+)((\/\w+)*\/)([\w\-\.]+[^#?\s]+)(.*)?(#[\w\-]+)?$/;c[a]=a.match(b)}return c[a]},Utility.getPathWithFilename=function(){return window.location.href.replace(window.location.search,"").replace(window.location.hash,"").replace("?","")},Utility.getPath=function(a){a||(a=window.location.href);var b=a.indexOf("?")==-1?a:a.substr(0,a.indexOf("?"));b.indexOf("#")!==-1&&(b=b.substr(0,b.indexOf("#")));var c=b.split("/"),d=c[c.length-1];for(d.indexOf(".")!==-1&&c.pop(),b=c.join("/");b.length&&"/"==b.charAt(b.length-1);)b=b.slice(0,b.length-1);return b+="/"},Utility.getProtocol=function(a){return a||(a=window.location.href),Utility.analyzeURL(a)[2]},Utility.urlParams=function(){var a=decodeURIComponent(window.location.href),b=a.split("?")[1];if(!b)return{};b=b.split("#")[0];for(var c={},d=b.split("&"),e=0;e<d.length;e++){var f=d[e].split("=");c[f[0]]=f[1]}return c}(),Utility.isLocalhost=function(){var a=window.location.toString().split("/")[2];return"localhost"==a||"192"==a.split(".")[0]}(),Utility.preloadImages=function(a,b,c,d){function e(){function g(){null!=i&&(i.collector[i.name]=j),j.onerror=null,j.onload=null,e()}if(c&&c.apply(null,[f/a.length*100<<0]),f>=a.length)return void(b&&b.apply());var h=a[f],i=null;"string"!=typeof h&&(i=h,h=i.url),f++;var j=new Image;j.onload=g,d&&(j.onerror=function(){console.error("load image error: ["+h+"]"),g()}),j.src=h}if(null==d&&(d=!0),!a||0==a.length)return void(b&&b.apply());var f=0;e()},Utility.shuffleArray=function(a){for(var b,c,d=a.length;d;b=Math.floor(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a},Utility.isiOS=function(){var a=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"];if(navigator.platform)for(;a.length;)if(navigator.platform===a.pop())return!0;return!1}}(),function(){var a=window.PatternSamples={};a.email=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,a.phone=/^(09)[0-9]{8}$/,a.number=/[0-9]/g,a.nonNumber=/[^0-9]/g,a.onlySpace=/^\s*$/,a.localPhone=/^(0)\d{1,3}(-)\d{5,8}$/,a.personId=/^[A-Z]{1}[1-2]{1}[0-9]{8}$/,a.numberAndLetters=/^[a-zA-Z0-9]*$/}(),function(){function a(a){var d=$(a);if(!a._viewports){var e=d.attr("resizable"),f=e.split(";");a._viewports=[];for(var g=0;g<f.length;g++){var h=!1,i=f[g];i.match("c")&&(h=!0,i=i.replace("c",""));var j=i.split("p"),k=j[0]?j[0].split("x"):[0,0],l=j[1]?j[1].split("x"):[0,0],m=!!l;a._viewports.push({w:parseInt(k[0]),h:parseInt(k[1]),paddingW:parseInt(l[0]),paddingH:parseInt(l[1]),hasPadding:m,resizeByParent:h})}}var n=a._viewports[c.modeIndex];if(n){if(ScalableContent.enableDrawBounds&&!a._boundDom&&b(d,n),a._boundDom){$(a._boundDom).css("width",n.w+"%").css("height",n.h+"%").css("left",.5*-n.w+"%").css("top",.5*-n.h+"%");var o=n.w+" x "+n.h;(n.paddingW||n.paddingH)&&(o="size: "+o+"</br>padding: "+n.paddingW+" x "+n.paddingH),a._boundDom.textDom.innerHTML=o}var p=c.width,q=c.height;if(n.resizeByParent){var r=d.parent();p=r.width(),q=r.height()}var s=Helper.getSize_contain(p-2*n.paddingW,q-2*n.paddingH,n.w,n.h).ratio;s>1&&(s=1),d.css("width",100*s).css("height",100*s).css("font-size",100*s+"px")}}function b(a,b){if(ScalableContent.enableDrawBounds){var c=document.createElement("div");c.className="text";var d=document.createElement("div");d.className="bound",$(d).css("width",b.w+"%").css("height",b.h+"%").css("left",.5*-b.w+"%").css("top",.5*-b.h+"%").css("font-size",16),d.appendChild(c),d.textDom=c,a.prepend(d),a[0]._boundDom=d}}var c={width:0,height:0,viewWidthRanges:[640,1280],modeIndex:-1,modeChanged:!1};window.ScalableContent={enableFixFullImage:!0,enableDrawBounds:!0,init:function(a){c.viewWidthRanges=a},updateView:function(a,b){for(var d=c,e=d.modeIndex,f=0;a>d.viewWidthRanges[f]&&f<d.viewWidthRanges.length;)f++;return d.modeIndex=f,d.modeChanged=e!=d.modeIndex,d.width=a,d.height=b,d},updateResizeAble:function(){var b=$(document).find("[resizable]");$.each(b,function(b,c){a(c)})},fixFullImage:function(a){if(ScalableContent.enableFixFullImage){var b=a.find("[full-image='']");$.each(b,function(a,b){var c,d=$(b);if(d.attr("full-image","handled"),c=d.css("background-image")){c=c.slice(5,c.length-2);var e=document.createElement("img");e.setAttribute("width","100%"),e.setAttribute("height","100%"),e.setAttribute("full-size-image-for",b.className),e.src=c,e.className="full-size-image",$(b).prepend(e).css("background-image","none")}}),b=a.find("[full-btn]"),$.each(b,function(a,b){var c=$(b);c.removeAttr("full-btn"),c.toggleClass("full-size-btn",!0),c.find("img").toggleClass("full-size-btn-image",!0)}),b=a.find("[hover-fix]"),$.each(b,function(a,b){var c=$(b);c.removeAttr("hover-fix"),c.on("mouseover",function(){c.toggleClass("hovered",!0)}),c.on("mouseout",function(){c.toggleClass("hovered",!1)})})}}}}(),function(){function a(a){return h&&(a=h.call(null,a)),a}function b(a){a||(a=r),t&&k.getHash()!=a?k.setHash(a):k.toContent(a)}function c(){m=!1,null!=p&&(p.apply(),p=null),f&&f.apply()}var d,e,f,g,h,i,j,k=window.SceneHandler={},l={},m=!1,n=null,o=null,p=null,q=null,r="/Index",s=!1,t=!0,u={},v={},w=null;k.currentScene=null,k.processHashNames=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];_contentClasses.push(window[d]),b.push("/"+d)}return b},k.getLastHash=function(){return o},k.init=function(b,c){c=c||{},d=c.version||"0",e=c.cbBeforeChange,f=c.cbAfterChange,h=c.hashChangeTester,g=c.cbContentChange,q=c.cbContentLoaded,j=c.loadingClass,r=c.defaultHash||"/Index",t=void 0===c.listeningHashChange||c.listeningHashChange;var i,n,o;if(c.blockHashs)for(i=0;i<c.blockHashs.length;i++)v[c.blockHashs[i]]=!0;var s,u,w;for(i=0;i<b.length;i++){if(n=b[i],s=n.split("/"),u=s[1],w=null,2==s.length);else{if(3!=s.length){console.error("illegal hash: "+n);continue}w="/"+s[2]}window[u]?(o={hash:n,index:i,stageClass:window[u],contentHash:w},l[n]=o):console.error("class for: "+u+" is not exist")}t&&k.onHashChange(function(b){""==b&&(b=r),(b=a(b))&&l[b]&&!v[b]&&(m?p=function(){k.toContent(b)}:k.toContent(b))})},k.setLock=function(a){s=a},k.onHashChange=function(a){function b(){s||(i?i=!1:a.apply(null,[k.getHash()]))}if("onhashchange"in window)window.onhashchange=function(){b()};else{var c=window.location.hash;window.setInterval(function(){window.location.hash!=c&&(c=window.location.hash,b())},100)}},k.toLastHash=function(){k.toHash(o)},k.toLastNonPopupHash=function(){k.toHash(w)},k.getHash=function(){return window.location.hash.replace("#","")},k.setHash=function(a,b){b&&(i=!0),window.location.hash="#"+a},k.toFirstHash=function(b){var c=k.getHash();if(t&&l[c]&&!v[c]||(c=r),c=a(c)){if(l[c].stageClass._isPopup){var d=c;p=function(){k.toContent(d)},c=r}return k.toContent(c,b),c}},k.toHash=function(a){v[a]?k.toContent(a):b(a)},k.toContent=function(a,b){if(!m&&(""==a&&(a=r),n!=a)){var d,f;if(b||(b={}),b.firstIn=!1,b.cbContentLoaded=q,m=!0,g&&g.call(null,a),b.lastHash=n,null==n)b.isFirstIn=!0,o=n,n=a,d=l[a],b.contentHash=d.contentHash,k.currentScene=d.stageClass,k.currentScene._isPopup||(w=n),d.stageClass.stageIn(b,c);else if(l[n]&&l[a])if(e&&e.apply(),f=l[n],d=l[a],o=n,n=a,f.stageClass===d.stageClass&&d.contentHash!==f.contentHash)f.stageClass.toContent(d.contentHash,function(){c()});else{k.currentScene=d.stageClass;var h=f.stageClass,i=d.stageClass,j=w;b.contentHash=d.contentHash,k.currentScene._isPopup||(w=n),1!=h._isPopup||i._isPopup?h._isPopup||1!=i._isPopup?1==h._isPopup&&1==i._isPopup?(h.hide(),i.show(c)):f.stageClass.stageOut(b,function(){d.stageClass.stageIn(b,c)}):i.show(c):j&&j!==n?(h.hide(),l[j].stageClass.stageOut(b,function(){d.stageClass.stageIn(b,c)})):h.hide(function(){i.executeAfterPopupClosed&&i.executeAfterPopupClosed.call(),c()})}}},k.loadTemplate=function(a,b,c,e,f){function g(a){function k(){a++,a>=b.length?(!j||f||e||j.hide(),c.apply(null)):g(a)}if(0==b.length)return j&&!f&&j.hide(),void c.apply(null);null==a&&(a=0);var l,m=b[a],n=m.url;m.startWeight&&(h=m.startWeight),m.weight&&(i=m.weight),u[n]?(m.dom=u[n],k()):(j&&!f&&j.progress(.01*h),l=document.createElement("div"),$(l).load(n+"?v="+d,function(){u[n]=l;var a=b.extractClass;a||(a="extract-point");var c=m.dom=$(l).find("."+a)[0];$(c).toggleClass(a,!1),$("#invisible-container").append(c),$(c).waitForImages(function(){if(c.parentNode&&c.parentNode.removeChild(c),j&&!f){var a=(h+i)/100;j.progress(a)}k()},function(a,b){if(j&&!f){var c=(h+a/b*i)/100;j.progress(c)}},!0)}))}j&&!f&&j.show();var h=0,i=100;null!=a?Utility.preloadImages(a.list,g,function(a){j&&!f&&j.progress(a/100)}):g(0)}}(),function(){"use strict";function a(){if(history&&history.replaceState){var a=SceneHandler.getHash(),b=Helper.removeURLParameter(location.href,"serial")+"#"+a;window.history.replaceState({path:b},"",b)}Entries.firstEntrySerial=Utility.urlParams.serial,SceneHandler.toHash("/Entries")}function b(){if(location.hash.match("access_token")&&location.hash.match("state")){var a=location.hash.replace("#","?");if(a){f.settings.fbToken=Helper.getParameterByName("access_token",a);var b=Helper.getParameterByName("state",a);window.location.hash="#"+b,c()}}}function c(){if(history&&history.replaceState){var a=Main.settings.fbState,b=Helper.removeURLParameter(location.href,"code");b=Helper.removeURLParameter(b,"state");var c=SceneHandler.getHash();b=b.replace("?#"+c,"").replace("#"+c,""),b+="#"+a,window.history.replaceState({path:b},"",b)}}function d(a,b,c){function d(){var b=c?encodeURI(c):encodeURI(Utility.getPathWithFilename()),d="https://www.facebook.com/dialog/oauth?response_type=token&client_id="+Main.settings.fb_appid+"&scope="+Main.settings.fbPermissions.join(",")+"&state="+a+"&redirect_uri="+b;window.open(d,"_self")}function e(a){a&&(Main.settings.fbToken=a.accessToken,Main.settings.fbUid=a.userID),Loading.hide(),b&&b.apply()}a||(a="/Index"),Loading.progress("登入 Facebook 中...請稍候").show(),Main.settings.fbUid?e():Main.settings.isiOS||Main.settings.isLineBrowser?FB.getLoginStatus(function(a){"connected"===a.status?e(a.authResponse):d()}):FB.login(function(a){a.error?alert("登入 Facebook 失敗"):a.authResponse?e(a.authResponse):Loading.hide()},{scope:Main.settings.fbPermissions,return_scopes:!0,auth_type:"rerequest"})}function e(){var a=$(window).width(),b=$(window).height(),c=ScalableContent.updateView(a,b);f.settings.viewport.changed=c.modeChanged,f.settings.viewport.index=c.modeIndex,SceneHandler.currentScene&&SceneHandler.currentScene.resize(),CommonForm.resize()}var f=window.Main={localSettings:{fb_appid:"1896326817270897"},settings:{isLocal:!1,isMobile:!1,useFakeData:!1,fb_appid:"1896325417271037",fbPermissions:[],fbToken:null,fbUid:null,fbState:null,isiOS:!1,isLineBrowser:!1,viewport:{width:0,height:0,ranges:[640],index:-1,changed:!1}},hashArray:["/Index","/Reviewer","/Rule","/Participate","/Entries","/Fill"],firstHash:"",defaultHash:"/Index",init:function(){function c(){SceneHandler.init(Main.hashArray,{defaultHash:f.defaultHash,listeningHashChange:!0,loadingClass:Loading,version:(new Date).getTime(),cbBeforeChange:function(){Menu.close()},hashChangeTester:function(a){return"/Participate"==a&&f.settings.isLineBrowser?(alert("您的瀏覽器不支援上傳檔案, 請使用其他的瀏覽器瀏覽此單元"),a=null,SceneHandler.setHash("/Index"),null):"1"==Utility.urlParams.debug||"/Participate"!=a&&"/Fill"!=a||Main.settings.fbToken?"/Participate"!=a&&"/Fill"!=a||Modernizr.canvas?a:(alert("您的瀏覽器不支援 html5 canvas, 請使用其他的瀏覽器瀏覽此單元"),a=null,SceneHandler.setHash("/Index"),null):(a=null,SceneHandler.setHash("/Index"),null)}}),Utility.urlParams.serial?a():SceneHandler.toFirstHash()}"local.savorks.com"!=window.location.host&&"socket.savorks.com"!=window.location.host||($.extend(f.settings,f.localSettings),Main.settings.isLocal=!0,"1"==Utility.urlParams.usefakedata&&(Main.settings.useFakeData=!0)),ScalableContent.init(f.settings.viewport.ranges),ScalableContent.enableFixFullImage=!0,ScalableContent.enableDrawBounds=!0,f.settings.isLineBrowser=Boolean(navigator.userAgent.match("Line")),f.settings.isiOS=Utility.isiOS(),window._CLICK_=f.settings.isiOS?"touchend":"click",Menu.init(),CommonForm.init(),EntryView.init(),b(),FBHelper.init(Main.settings.fb_appid),c(),$(window).on("resize",e),e()},testCanvas:function(a){$(a).css({position:"fixed",top:0,left:0}),$("body").append(a)},loginFB:d}}(),function(){var a={},b=!1,c=window.Menu={init:function(){a.container=$("#menu"),a.btnIcon=a.container.find(".icon").on(_CLICK_,function(){b?c.close():c.open()}),a.buttonContainer=a.container.find(".button-container"),a.btnIndex=a.container.find(".btn:nth-child(1)").on(_CLICK_,function(){c.close(),SceneHandler.toHash("/Index")}),a.btnReviewer=a.container.find(".btn:nth-child(2)").on(_CLICK_,function(){c.close(),SceneHandler.toHash("/Reviewer")}),a.btnParticipate=a.container.find(".btn:nth-child(3)").on(_CLICK_,function(){c.close(),Main.loginFB("/Participate",function(){SceneHandler.toHash("/Participate")})}),a.btnFill=a.container.find(".btn:nth-child(4)").on(_CLICK_,function(){c.close(),Main.loginFB("/Fill",function(){SceneHandler.toHash("/Fill")})}),a.btnEntries=a.container.find(".btn:nth-child(5)").on(_CLICK_,function(){c.close(),Main.loginFB("/Entries",function(){SceneHandler.toHash("/Entries")})}),a.btnRule=a.container.find(".btn:nth-child(6)").on(_CLICK_,function(){c.close(),SceneHandler.toHash("/Rule")}),a.btnWinners=a.container.find(".btn:nth-child(7)").on(_CLICK_,function(){}).css("display","none"),a.btnShows=a.container.find(".btn:nth-child(8)").on(_CLICK_,function(){}).css("display","none")},open:function(){b||(b=!0,a.buttonContainer.toggleClass("open-mode",!0))},close:function(){b&&(b=!1,a.buttonContainer.toggleClass("open-mode",!1))}}}(),function(){var a={participate:{error:"",serial:"00001"},entries_vote:{error:""},entries_search:{error:"",data:[{serial:"0088",status:"approved",name:"John",num_votes:"31231",thumb_url:"http://xxxx.xx/thumbxxx.jpg",url:"http://xxxx.xx/imagexxx.jpg",description:"bablalalala"}],num_pages:13,page_index:3,page_size:10},"entries_search.serial":{error:"",data:[{serial:"0088",status:"approved",name:"John",num_votes:"31231",thumb_url:"./images/entries-list-thumb-sample.png",url:"./images/entries-list-thumb-sample.png",description:"bablalalala"}],num_pages:1,page_index:0,page_size:1},"entries_search.single":{error:"",data:[{serial:"7354",status:"approved",name:"John",num_votes:"6945",thumb_url:"./images/entries-list-thumb-sample.png",url:"./images/entries-list-thumb-sample.png",description:"bablalalala"}],num_pages:123,page_index:0,page_size:1},filling_attending:{error:"",share_url:"https://2016summer.tw/misc/fb-share.jpg"},index_get_entry:{error:"",serial:"0322",name:"John Tester",thumb_url:"./images/entries-list-thumb-sample.png"}};window.ApiProxy={callApi:function(b,c,d,e){function f(a){e&&e.call(null,a)}var g="../process/"+b;if(Main.settings.useFakeData&&d){d===!0&&(d=b);var h=a[d];if("entries_search"==d){h.page_index=c.page_index,h.data=[];var i,j,k=c.page_index,l=k*c.page_size,m=123;for(j=0;j<c.page_size&&(i=l+j,h.data.push({serial:i,name:"name "+i,num_votes:parseInt(3e3*Math.random()),description:"description "+i,thumb_url:"./images/entries-list-thumb-sample.png",url:"./images/entries-list-thumb-sample.png"}),!(i>=m-1));j++);}else"entries_search.single"==d&&(h.page_index=c.page_index,h.data[0].serial=h.page_index);f(h)}else $.ajax({url:g,type:"POST",data:c,dataType:"json"}).done(f).fail(function(){f({error:"無法取得伺服器回應"})})}}}(),function(){function a(){f.optionalFields.toggleClass("hidding",!0),f.arrowLeft.css("display","none"),f.arrowRight.css("display","none"),c(!1)}function b(a){f.optionalFields.toggleClass("hidding",!1),a?(f.arrowLeft.css("display","block"),f.arrowRight.css("display","block"),e&&(f.arrowLeft.css("visibility","visible"),f.arrowRight.css("visibility","visible"),e.page_index<=0&&f.arrowLeft.css("visibility","hidden"),e.page_index>=e.num_pages-1&&f.arrowRight.css("visibility","hidden"))):(f.arrowLeft.css("display","none"),f.arrowRight.css("display","none")),c(!0)}function c(a){a?(f.btnToList.toggleClass("hidding",!1),f.btnVote.toggleClass("hidding",!1)):(f.btnToList.toggleClass("hidding",!0),f.btnVote.toggleClass("hidding",!0))}var d,e,f={},g=!0,h=!1,i=window.EntryView={init:function(){f.parent=$("#scene-container"),f.container=$("#entry-view"),f.content=f.container.find(".wrapper"),f.imagePreview=f.container.find(".image-preview"),f.optionalFields=f.container.find(".optional-fields"),f.arrowLeft=f.container.find(".arrow-left").on("click",function(){h||e&&(e.page_index--,e.page_index<0&&(e.page_index=0),i.showEntryAt(e))}),f.arrowRight=f.container.find(".arrow-right").on("click",function(){h||e&&(e.page_index++,e.page_index>=e.num_pages&&(e.page_index=e.num_pages-1),i.showEntryAt(e))}),f.fields={numVotes:f.container.find(".field-num-votes"),serial:f.container.find(".field-serial"),author:f.container.find(".field-author"),description:f.container.find(".field-description")},f.btnClose=f.container.find(".btn-close").on("click",function(){i.hide()}),f.btnToList=f.container.find(".btn-to-list").on("click",function(){i.hide()}),f.btnVote=f.container.find(".btn-vote").on("click",function(){i.hide(),Main.loginFB("/Entries",function(){CommonForm.setVotingSerial(d.serial),Entries.toStep("vote")})}),f.container.detach()},showPreview:function(b,c){f.imagePreview.empty(),f.imagePreview.append(b),f.fields.description.text(c),a(),i.show()},showEntry:function(a,c){d=a;var e=document.createElement("img");e.src=a.url,f.imagePreview.empty(),f.imagePreview.append(e),f.fields.description.text(a.description),f.fields.numVotes.text(a.num_votes),f.fields.author.text(a.name),f.fields.serial.text(a.serial),b(c),i.show()},showEntryAt:function(a){e=a,h=!0,Loading.progress("資料讀取中...").show(),ApiProxy.callApi("entries_search",a,"entries_search.single",function(a){TweenMax.delayedCall(.5,function(){a.error?alert(a.error):(e.num_pages=parseInt(a.num_pages),i.showEntry(a.data[0],!0),h=!1,Loading.hide())})})},show:function(a,b){if(g){g=!1,f.parent.append(f.container),$("#scene-container").toggleClass("extend-mode",!0),void 0===a&&(a=0);var c=new TimelineMax;c.set(f.container,{autoAlpha:0}),c.set(f.content,{marginTop:-300}),c.to(f.container,.3,{autoAlpha:1},a),c.to(f.content,.6,{marginTop:0,ease:Back.easeOut},a),c.add(function(){b&&b.apply()})}},hide:function(a,b){if(!g){g=!0;var c=new TimelineMax;c.to(f.container,.4,{autoAlpha:0},a),c.add(function(){$("#scene-container").toggleClass("extend-mode",!1),f.container.detach(),b&&b.apply()})}}}}(),function(){function a(){g.fields.name.val(""),g.fields.phone.val(""),g.fields.email.val(""),g.fields.ruleCheck[0].checked=!1}function b(){var a=c();if(a){var b,e;"participate"==j?(b=Participate.UploadStep.getRawCanvas(),b?(e=b.toDataURL("image/jpeg",.95).replace(/^data:image\/jpeg;base64,/,""),a.image_data=e,a.description=Participate.UploadStep.getDescriptionInput(),Loading.progress("資料傳輸中 ... 請稍候").show(),ApiProxy.callApi("participate",a,!0,function(a){a.error?alert(a.error):(Participate.Success.setShareEntrySerial(a.serial),Participate.Success.show()),Loading.hide()})):alert("lack image data")):"vote"==j?d?(a.serial=d,Loading.progress("資料傳輸中 ... 請稍候").show(),ApiProxy.callApi("entries_vote",a,!0,function(a){a.error?alert(a.error):(Entries.VoteSuccess.setShareEntrySerial(d),Entries.VoteSuccess.setShareImageUrl(a.share_url),Entries.VoteSuccess.show()),Loading.hide()})):alert("lack voting serial"):"fill"==j?(b=Fill.getSendingCanvas(),b?(e=b.toDataURL("image/jpeg",.95).replace(/^data:image\/jpeg;base64,/,""),a.image_data=e,a.contents=Fill.getDescription(),a.illust_index=Fill.getIllustIndex(),Loading.progress("資料傳輸中 ... 請稍候").show(),ApiProxy.callApi("filling_attending",a,!0,function(a){a.error?alert(a.error):(Fill.Success.setShareImageUrl(a.share_url),Fill.Success.show()),Loading.hide()})):alert("lack image data")):alert("unsupported mode")}}function c(){var a,b={};return g.fields.ruleCheck.prop("checked")?(a=g.fields.name[0],PatternSamples.onlySpace.test(a.value)?(alert("請輸入您的名稱"),void a.focus()):(b.name=a.value,a=g.fields.phone[0],PatternSamples.phone.test(a.value)?(b.phone=a.value,a=g.fields.email[0],PatternSamples.email.test(a.value)?(b.email=a.value,b.fb_uid=Main.settings.fbUid,b.fb_token=Main.settings.fbToken,k=b.name,b):(alert("請輸入您的電子郵件信箱"),void a.focus())):(alert("請輸入正確的手機號碼"),void a.focus()))):void alert('您必須同意 "授權主辦單位使用本人個人資料" 才能參加活動')}var d,e,f,g={},h=!0,i=!1,j=null,k=null,l=window.CommonForm={init:function(){i=!0,g.parent=$("#scene-container"),g.container=$("#common-form"),g.desc=g.container.find(".desc"),g.eulaContentContainer=g.container.find(".content-container"),e=new SimpleScroller(g.eulaContentContainer[0],null,0,Modernizr.touchevents).update(!0),g.fields={name:g.container.find(".field-name"),phone:g.container.find(".field-phone"),email:g.container.find(".field-email"),ruleCheck:g.container.find("#eula-checkbox")},g.btnSend=g.container.find(".btn-send").on("click",function(){b()}),g.container.detach()},show:function(b,c){if(h){h=!1,g.parent.append(g.container),l.resize(),a(),void 0===b&&(b=0);var d=new TimelineMax;d.set(g.container,{autoAlpha:0}),d.to(g.container,.4,{autoAlpha:1},b),d.add(function(){c&&c.apply()})}},hide:function(a,b){if(!h){h=!0;var c=new TimelineMax;c.to(g.container,.4,{autoAlpha:0},a),c.add(function(){g.container.detach(),b&&b.apply()})}},setVotingSerial:function(a){d=a},setMode:function(a){return j=a,g.desc.toggleClass("participate",!1),g.desc.toggleClass("vote",!1),g.desc.toggleClass("fill",!1),g.desc.toggleClass(a,!0),"participate"==a?f="parttime_form":"vote"==a?f="artworks_form":"fill"==a&&(f="copywork_form"),l},getLastUserName:function(){return k},resize:function(){if(i&&0==h){if(Main.settings.viewport.changed){var a=g.eulaContentContainer.height(),b=g.eulaContentContainer.width();e.containerSize(null,a).scrollBound(b-21,0,0,a-38).update(!0)}}}}}(),function(){function a(a){$("#invisible-container").append(a[0].dom),h.container=$("#index"),h.btnParticipate=h.container.find(".button-1").on(_CLICK_,function(){Main.loginFB("/Participate",function(){SceneHandler.toHash("/Participate")})}),h.btnFill=h.container.find(".button-2").on(_CLICK_,function(){Main.loginFB("/Entries",function(){SceneHandler.toHash("/Fill")})}),h.btnVote=h.container.find(".button-3").on(_CLICK_,function(){Main.loginFB("/Entries",function(){SceneHandler.toHash("/Entries")})}),b(),h.container.detach()}function b(){function a(a){if(!j){j=!0;var c={keyword:"",search_type:"user_name",status:"approved",sort_type:"date",page_index:0,page_size:1};if(f){var d=parseInt(f.page_index)+a;if(d>=parseInt(f.num_pages))return;if(d<0)return;c.page_index=d}ApiProxy.callApi("entries_search",c,"entries_search.serial",function(a){a.error?alert(a.error):(f=a,a.data.length>0&&b())})}}function b(){var a=f.data[0],b=document.createElement("img");$(b).css("position","absolute").css("left",0).css("top",0).attr("width","100%").attr("height","100%"),b.onload=function(){var d=g;h.sampleAuthor.text("作者："+a.name),g=b,TweenMax.from(g,.4,{opacity:0,onComplete:function(){d&&$(d).detach()}}),h.sampleThumb.append(g),j=!1,c()},b.src=a.thumb_url}h.thumbContainer=h.container.find(".thumb-block"),h.sampleThumb=h.thumbContainer.find(".thumb-image"),h.sampleAuthor=h.thumbContainer.find(".author-name"),h.arrowLeft=h.thumbContainer.find(".arrow-left").on("mousedown",function(){a(-1)}),h.arrowRight=h.thumbContainer.find(".arrow-right").on("mousedown",function(){a(1)}),a(0)}function c(){var a=parseInt(f.page_index);h.arrowLeft.toggleClass("hidding",a<=0),h.arrowRight.toggleClass("hidding",a>=parseInt(f.num_pages)-1)}function d(a){$("#scene-container").append(h.container),k.resize();var b=new TimelineMax;b.set(h.container,{autoAlpha:0}),b.to(h.container,.4,{autoAlpha:1}),b.add(function(){a.apply()})}function e(a){var b=new TimelineMax;b.to(h.container,.4,{autoAlpha:0}),b.add(function(){h.container.detach(),a.apply()})}var f,g,h={},i=!1,j=!1,k=window.Index={stageIn:function(b,c){function e(a){a&&b.cbContentLoaded&&b.cbContentLoaded.call(),d(c)}function f(b){var c=[{url:"_index.html",startWeight:0,weight:100,dom:null}];SceneHandler.loadTemplate(null,c,function(){a(c),i=!0,b.apply(null)},0)}i?e():f(e)},stageOut:function(a,b){e(b)},resize:function(){}}}(),function(){function a(a){function b(a){var b=h["reviewer-"+a]=h.container.find(".pic-"+a),c=h["desc-"+a]=h.container.find(".desc-"+a);h.elements.push(b[0],c[0]),b.on(_CLICK_,function(){d(a)})}$("#invisible-container").append(a[0].dom),h.container=$("#reviewer"),h.elements=[],b(1),b(2),h.arrowLeft=h.container.find(".arrow-left").on(_CLICK_,function(){var a=k-1;a<1&&(a=l),d(a)}),h.arrowRight=h.container.find(".arrow-right").on(_CLICK_,function(){var a=k+1;a>l&&(a=1),d(a)}),h.container.detach()}function b(){g&&(g.kill(),g=null);var a,b,d,e,f,i=Main.settings.viewport,l=-(k-1)*j;if(0==i.index)for(a=1;a<=2;a++)b=h["reviewer-"+a],d=h["desc-"+a],e=j*(a-1)+l+"%",f=a==k?1:.9,TweenMax.set(b,{marginLeft:e,scale:f}),TweenMax.set(d,{marginLeft:e,scale:f});else for(a=1;a<=2;a++)b=h["reviewer-"+a],d=h["desc-"+a],TweenMax.set(b,{marginLeft:0,scale:1}),TweenMax.set(d,{marginLeft:0,scale:1});c()}function c(){0==Main.settings.viewport.index?(console.log(k),h.arrowLeft.toggleClass("hidding",1==k),h.arrowRight.toggleClass("hidding",k==l)):(h.arrowLeft.toggleClass("hidding",!0),h.arrowRight.toggleClass("hidding",!0))}function d(a){if(a!=k){k=a,c();if(0==Main.settings.viewport.index){g&&g.kill();for(var b,d,e,f=-(k-1)*j,i=1;i<=2;i++){var l=h["reviewer-"+i],m=h["desc-"+i];b=j*(i-1)+f,d=b+"%",e=i==k?1:.9,g=new TimelineMax,g.to(l,.5,{marginLeft:d,scale:e},0),g.to(m,.5,{marginLeft:d,scale:e},0)}}}}function e(a){$("#scene-container").append(h.container),m.resize();var b=new TimelineMax;b.set(h.container,{autoAlpha:0}),b.to(h.container,.4,{autoAlpha:1}),b.add(function(){a.apply()})}function f(a){var b=new TimelineMax;b.to(h.container,.4,{autoAlpha:0}),b.add(function(){h.container.detach(),a.apply()})}var g,h={},i=!1,j=495,k=1,l=2,m=window.Reviewer={stageIn:function(b,c){function d(a){a&&b.cbContentLoaded&&b.cbContentLoaded.call(),e(c)}function f(b){var c=[{url:"_reviewer.html",startWeight:0,weight:100,dom:null}];SceneHandler.loadTemplate(null,c,function(){a(c),i=!0,b.apply(null)},0)}i?d():f(d)},stageOut:function(a,b){f(b)},resize:function(){i&&b()}}}(),function(){function a(a){d={upload:h.UploadStep,form:CommonForm},$("#invisible-container").append(a[0].dom),e.container=$("#participate"),h.UploadStep.init(e.container.find(".content-step-upload")),h.Success.init($("#participate-success")),h.ShareSuccess.init($("#participate-share-success")),e.container.detach()}function b(a){$("#scene-container").append(e.container),h.resize(),g="upload",d[g].show(0,a)}function c(a){d[g].hide(0,function(){e.container.detach(),a.apply()})}var d,e={},f=!1,g="upload",h=window.Participate={stageIn:function(c,d){function e(a){a&&c.cbContentLoaded&&c.cbContentLoaded.call(),b(d)}function g(b){var c=[{url:"_participate.html",startWeight:0,weight:100,dom:null}];SceneHandler.loadTemplate(null,c,function(){a(c),f=!0,b.apply(null)},0)}f?e():g(e)},stageOut:function(a,b){c(b)},toStep:function(a){a!=g&&(d[g].hide(),g=a,"form"==g&&CommonForm.setMode("participate"),d[g].show())},resize:function(){}}}(),function(){function a(){g=!!k.getImage(),h=k.getDescriptionInput().length>=20,i=d.ruleCheckbox[0].checked;var a=g&&h&&i;d.btnSend.toggleClass("disactivated",!a),d.btnPreview.toggleClass("disactivated",!g)}function b(b){b.defaultText=b.val(),b.on("focus",function(){b.val()==b.defaultText&&b.val("")}).on("blur",function(){""==b.val()&&b.val(b.defaultText)}).on("input propertychange",function(){a()})}function c(){function b(a,b){if(a.files&&a.files[0]){var d=new FileReader;d.onload=function(a){c(a.target.result,b)},d.readAsDataURL(a.files[0])}}function c(a,b){f.image&&($(f.image).detach(),f.image=null),f.rawCanvas&&($(f.rawCanvas).detach(),f.rawCanvas=null),f.previewCanvas&&($(f.previewCanvas).detach(),f.previewCanvas=null),f.thumbCanvas&&($(f.thumbCanvas).detach(),f.thumbCanvas=null),f.image=document.createElement("img"),f.image.onload=function(){if(f.image.width!=j.raw.w||f.image.height!=j.raw.h){var a="您所上傳的圖片尺寸 ( "+f.image.width+" x "+f.image.height+" ) 和我們的作品規格 ( "+j.raw.w+" x "+j.raw.h+" ) 不同\n\n將自動裁切或縮放, 請預覽圖片確定內容是否正確.";alert(a)}b&&b.call()},f.image.src=a}var e=d.container.find(".image-input")[0];d.btnSelectImage=d.container.find(".btn-upload").on("click",function(){e.value=null,e.click()}),$(e).on("change",function(){Loading.progress("empty").show(),b(e,function(){a(),Loading.hide()})})}var d={},e=!0,f={},g=!1,h=!1,i=!1,j={raw:{w:1200,h:900},preview:{w:474,h:356},thumb:{w:133,h:100}},k=window.Participate.UploadStep={init:function(e){d.container=e,d.parent=e.parent(),d.textArea=d.container.find(".description"),b(d.textArea),c(),d.btnRule=d.container.find(".btn-rule").on("click",function(){SceneHandler.toHash("/Rule")}),d.ruleCheckbox=d.container.find("#upload-checkbox").on("change",function(){a()}),d.btnSend=d.container.find(".btn-send").on("click",function(){g?h?i?Participate.toStep("form"):alert("您必須同意我們的活動辦法"):alert("請輸入 20 個字元以上的作品說明"):alert("請先選擇欲上傳的圖片")}),d.btnPreview=d.container.find(".btn-preview").on("click",function(){g?EntryView.showPreview(k.getPreviewCanvas(),k.getDescriptionInput()):alert("請先選擇欲上傳的圖片")}),d.container.detach()},show:function(b,c){if(e){e=!1,d.parent.append(d.container),a(),void 0===b&&(b=0);var f=new TimelineMax;f.set(d.container,{autoAlpha:0,marginLeft:100}),f.to(d.container,.4,{autoAlpha:1,marginLeft:0},b),f.add(function(){c&&c.apply()})}},hide:function(a,b){if(!e){e=!0;var c=new TimelineMax;c.to(d.container,.4,{autoAlpha:0},a),c.add(function(){d.container.detach(),b&&b.apply()})}},getDescriptionInput:function(){var a=d.textArea.val();return a==d.textArea.defaultText&&(a=""),a},getRawCanvas:function(){return k.getCanvas("raw")},getPreviewCanvas:function(){return k.getCanvas("preview")},getThumbCanvas:function(){return k.getCanvas("thumb")},getImage:function(){return f.image},getCanvas:function(a){var b=a+"Canvas";if(!f[b]){if(!f.image)return null;var c=j[a];f[b]=Helper.imageToCanvas(f.image,c.w,c.h)}return f[b]}}}(),function(){var a={},b=!0,c=null,d=window.Participate.Success={init:function(b){a.container=b,a.content=a.container.find(".content"),a.parent=$("body"),a.btnClose=a.container.find(".btn-close").on("click",function(){d.hide(),SceneHandler.toHash("/Entries")}),a.btnShare=a.container.find(".btn-share").on("click",function(){FB.ui({method:"feed",display:"iframe",link:Utility.getPath()+"?serial="+c},function(a){a&&a.post_id&&(d.hide(),Participate.ShareSuccess.show())})}),a.container.detach()},show:function(c,d){if(b){b=!1,a.parent.append(a.container),void 0===c&&(c=0);var e=new TimelineMax;e.set(a.container,{autoAlpha:0}),e.to(a.container,.4,{autoAlpha:1},c),e.set(a.content,{marginTop:-30},0),e.to(a.content,.4,{marginTop:-130},c),e.add(function(){d&&d.apply()})}},hide:function(c,d){if(!b){b=!0;var e=new TimelineMax;e.to(a.container,.2,{autoAlpha:0},c),e.add(function(){a.container.detach(),d&&d.apply()})}},setShareEntrySerial:function(a){c=a}}}(),function(){var a={},b=!0,c=null,d=window.Participate.ShareSuccess={init:function(b){a.container=b,a.content=a.container.find(".content"),a.parent=$("body"),a.btnClose=a.container.find(".btn-close").on("click",function(){d.hide(),SceneHandler.toHash("/Entries")}),a.btnToNext=a.container.find(".btn-to-next").on("click",function(){d.hide(),SceneHandler.toHash("/Fill")}),a.container.detach()},show:function(c,d){if(b){b=!1,a.parent.append(a.container),void 0===c&&(c=0);var e=new TimelineMax;e.set(a.container,{autoAlpha:0}),e.to(a.container,.4,{autoAlpha:1},c),e.set(a.content,{marginTop:-30},0),e.to(a.content,.4,{marginTop:-130},c),e.add(function(){d&&d.apply()})}},hide:function(c,d){if(!b){b=!0;var e=new TimelineMax;e.to(a.container,.4,{autoAlpha:0},c),e.add(function(){a.container.detach(),d&&d.apply()})}},setShareEntrySerial:function(a){c=a}}}(),function(){function a(a){$("#invisible-container").append(a[0].dom),e.container=$("#entries"),d={list:h.List,vote:CommonForm},h.Title.init(e.container.find(".content-title")),h.List.init(e.container.find(".content-list")),h.Reviewing.init($("#entries-reviewing")),h.Unapproved.init($("#entries-unapproved")),h.VoteSuccess.init($("#entries-vote-success")),e.container.detach()}function b(a){$("#scene-container").append(e.container),h.resize(),g="list",h.Title.update(g),h.List.show(0,a)}function c(a){d[g].hide(0,function(){e.container.detach(),a.apply()})}var d,e={},f=!1,g="upload",h=window.Entries={firstEntrySerial:null,stageIn:function(c,d){function e(a){a&&c.cbContentLoaded&&c.cbContentLoaded.call(),b(d)}function g(b){var c=[{url:"_entries.html",startWeight:0,weight:100,dom:null}];SceneHandler.loadTemplate(null,c,function(){a(c),f=!0,b.apply(null)},0)}f?e():g(e)},stageOut:function(a,b){c(b)},toStep:function(a){a!=g&&(d[g].hide(),g=a,h.Title.update(g),"vote"==g&&CommonForm.setMode("vote"),d[g].show())},resize:function(){var a=Main.settings.viewport;h.List.resize(a)}}}(),function(){var a={},b=!0;window.Entries.Title={init:function(b){a.container=b,a.parent=b.parent(),a.container.detach()},show:function(c,d){if(b){b=!1,a.parent.append(a.container),void 0===c&&(c=0);var e=new TimelineMax;e.set(a.container,{autoAlpha:0,marginLeft:-100}),e.to(a.container,.4,{autoAlpha:1,marginLeft:0},c),e.add(function(){d&&d.apply()})}},hide:function(c,d){if(!b){b=!0;var e=new TimelineMax;e.to(a.container,.4,{autoAlpha:0},c),e.add(function(){a.container.detach(),d&&d.apply()})}},update:function(b){a.container.toggleClass("form-mode","vote"==b)}}}(),function(){var a,b,c={},d=!0,e=window.Entries.VoteSuccess={init:function(d){c.container=d,c.parent=$("body"),c.btnClose=c.container.find(".btn-close").on("click",function(){e.hide(),Entries.toStep("list")}),c.btnShare=c.container.find(".btn-share").on("click",function(){FB.ui({method:"share",display:"iframe",href:Utility.getPath()+"?serial="+a,title:CommonForm.getLastUserName()+"參加了輕鬆小品暑假打工爽的咧",description:"客倌們快來看看超有梗會笑出腹肌的爽畫作們啊～立即爽投票＋分享好友還有機會獲得7-11禮券＄200，多爽呀～～",picture:b+"?v="+(new Date).getTime()},function(a){a.error||a.error_code||(alert("分享成功"),e.hide(),Entries.toStep("list"))})}),c.container.detach()},show:function(a,b){if(d){d=!1,c.parent.append(c.container),void 0===a&&(a=0);var e=new TimelineMax;e.set(c.container,{autoAlpha:0,marginTop:50}),e.to(c.container,.4,{autoAlpha:1,marginTop:0},a),e.add(function(){b&&b.apply()})}},hide:function(a,b){if(!d){d=!0;var e=new TimelineMax;e.to(c.container,.4,{autoAlpha:0},a),e.add(function(){c.container.detach(),b&&b.apply()})}},setShareEntrySerial:function(b){a=b},setShareImageUrl:function(a){b=a}}}(),function(){var a={},b=!0,c=window.Entries.Reviewing={init:function(b){a.container=b,a.parent=$("body"),a.btnClose=a.container.find(".btn-close").on("click",function(){c.hide()}),a.btnEntries=a.container.find(".btn-entries").on("click",function(){c.hide()}),a.container.detach()},show:function(c,d){if(b){b=!1,a.parent.append(a.container),void 0===c&&(c=0);var e=new TimelineMax;e.set(a.container,{autoAlpha:0,marginTop:50}),e.to(a.container,.4,{autoAlpha:1,marginTop:0},c),e.add(function(){d&&d.apply()})}},hide:function(c,d){if(!b){b=!0;var e=new TimelineMax;e.to(a.container,.4,{autoAlpha:0},c),e.add(function(){a.container.detach(),d&&d.apply()})}}}}(),function(){var a={},b=!0,c=window.Entries.Unapproved={init:function(b){a.container=b,a.parent=$("body"),a.btnClose=a.container.find(".btn-close").on("click",function(){c.hide()}),a.btnEntries=a.container.find(".btn-entries").on("click",function(){c.hide()}),a.container.detach()},show:function(c,d){if(b){b=!1,a.parent.append(a.container),void 0===c&&(c=0);var e=new TimelineMax;e.set(a.container,{autoAlpha:0,marginTop:50}),e.to(a.container,.4,{autoAlpha:1,marginTop:0},c),e.add(function(){d&&d.apply()})}},hide:function(c,d){if(!b){b=!0;var e=new TimelineMax;e.to(a.container,.4,{autoAlpha:0},c),e.add(function(){a.container.detach(),d&&d.apply()})}}}}(),function(){function a(){if(Entries.firstEntrySerial){var a=Entries.firstEntrySerial;Entries.firstEntrySerial=null;var b={keyword:parseInt(a),search_type:"serial",status:"",sort_type:"date",page_index:0,page_size:1};ApiProxy.callApi("entries_search",b,"entries_search.serial",function(b){if(b.error)alert(b.error);else if(0==b.data.length)alert("很抱歉, 作品編號 ["+a+"] 並不存在");else{var c=b.data[0];"approved"==c.status?EntryView.showEntry(c):(c.status="reviewing")?Entries.Reviewing.show():(c.status="unapproved")&&Entries.Unapproved.show()}})}}function b(){g.loadingHint.css("display","block"),g.pageIndexContainer.css("display","none"),g.arrowLeft.css("visibility","hidding"),g.arrowRight.css("visibility","hidding")}function c(){g.arrowLeft.css("visibility","visible"),g.arrowRight.css("visibility","visible");var a=[g.arrowLeft,g.arrowRight,g.pageIndexContainer],b=new TimelineMax;b.set(a,{opacity:0}),b.to(a,.4,{opacity:1}),g.loadingHint.css("display","none"),g.pageIndexContainer.css("display","block")}function d(a,b,c,d,e,g){var h=new q.Thumb(b,c,d,e,g);m.push(h),h.$dom.on("click",function(){var b=$.extend({},f),c=b.page_size*b.page_index+a;b.page_size=1,b.page_index=c,EntryView.showEntryAt(b)})}function e(a){var b,c;for(b=0;b<a.length;b++)c=a[b],c.destroy()}var f,g={},h=!0,i=!1,j="",k="date",l=10,m=[],n=[],o=!1,p={0:{w:10,h:10},1:{w:36,h:13}},q=window.Entries.List={init:function(a){g.container=a,g.parent=a.parent(),g.arrowLeft=g.container.find(".arrow-left").on("mousedown",function(){q.PageIndex.toPrevPage()}),g.arrowRight=g.container.find(".arrow-right").on("mousedown",function(){q.PageIndex.toNextPage()}),q.updateArrows(!1,!1),g.outputMask=g.container.find(".output-mask"),g.outputA=g.container.find(".output-container:nth-child(1)"),g.outputB=g.container.find(".output-container:nth-child(2)").detach(),q.Thumb.$sample=g.container.find(".thumb-container").detach(),g.pageIndexContainer=g.container.find(".page-index-container"),q.PageIndex.init(g.pageIndexContainer),g.loadingHint=g.container.find(".loading-hint").css("display","none"),g.keywordInput=g.container.find(".field-keyword").on("keyup",function(a){13==a.keyCode&&g.btnSearchName.click()}),g.btnSearchName=g.container.find(".btn-name").on("click",function(){i||(j=g.keywordInput.val(),q.doSearch(0,!0))}),g.btnSearchSerial=g.container.find(".btn-serial").on("click",function(){i||(j=parseInt(g.keywordInput.val()),g.keywordInput.val(""),q.doSearch(0,!0,null,!0))}),g.btnSortByDate=g.container.find(".tab-by-date").on("click",function(){i||q.changeSortType("date")}),g.btnSortByRank=g.container.find(".tab-by-rank").on("click",function(){i||q.changeSortType("votes")}),g.container.detach()},show:function(b,c){if(h){h=!1,Entries.Title.show(),g.parent.append(g.container),void 0===b&&(b=0);var d=new TimelineMax;d.set(g.container,{autoAlpha:0,marginLeft:100}),d.to(g.container,.4,{autoAlpha:1,marginLeft:0},b),d.add(function(){c&&c.apply(),o||(o=!0,g.keywordInput.val(""),j="",q.doSearch(0,!0)),a()})}},hide:function(a,b){if(!h){h=!0,Entries.Title.hide();var c=new TimelineMax;c.to(g.container,.4,{autoAlpha:0},a),c.add(function(){g.container.detach(),b&&b.apply()})}},resize:function(a){l=0==a.index?4:10},changeSortType:function(a){a!=k&&(i||(k=a,"date"==k?(g.btnSortByDate.toggleClass("activated",!0),g.btnSortByRank.toggleClass("activated",!1)):(g.btnSortByDate.toggleClass("activated",!1),g.btnSortByRank.toggleClass("activated",!0)),q.doSearch(0,!0)))},updateArrows:function(a,b){g.arrowLeft.css("display",a?"block":"none"),g.arrowRight.css("display",b?"block":"none")},doSearch:function(a,d,e,g){if(!i){i=!0,b();var h="bottom",m=j;d||(a>e?h="right":a<e&&(h="left"));var n={keyword:j,search_type:g?"serial":"user_name",status:g?"":"approved",sort_type:k,page_index:a,page_size:l};g?ApiProxy.callApi("entries_search",n,"entries_search.serial",function(a){if(a.error)alert(a.error);else if(0==a.data.length)alert("很抱歉, 作品編號 ["+m+"] 並不存在");else{var b=a.data[0];"approved"==b.status?EntryView.showEntry(b):(b.status="reviewing")?Entries.Reviewing.show():(b.status="unapproved")&&Entries.Unapproved.show()}c(),i=!1}):(f=n,ApiProxy.callApi("entries_search",n,"entries_search",function(a){a.error?alert(a.error):(q.PageIndex.update(parseInt(a.num_pages),parseInt(a.page_index)+1),q.updateEntries(a.data,h)),c()}))}},updateEntries:function(a,b){n=m,m=[];var c,e;for(c=0;c<a.length;c++)e=a[c],d(c,g.outputB,e.num_votes,e.name,e.serial,e.thumb_url);q.animeEntries(b)},animeEntries:function(a){var b=p[Main.settings.viewport.index];g.outputMask.append(g.outputB);var c=g.outputMask.height()+b.h,d=g.outputMask.width()+b.w,f=new TimelineMax,h=.5,j=Power3.easeInOut;"bottom"==a?(j=Power2.easeInOut,f.set(g.outputB,{left:0,top:c}),f.to(g.outputA,h,{top:-c,ease:j},0),f.to(g.outputB,h,{top:0,ease:j},0)):"right"==a?(h*=d/c,f.set(g.outputB,{left:d,top:0}),f.to(g.outputA,h,{left:-d,ease:j},0),f.to(g.outputB,h,{left:0,ease:j},0)):"left"==a&&(h*=d/c,f.set(g.outputB,{left:-d,top:0}),f.to(g.outputA,h,{left:d,ease:j},0),f.to(g.outputB,h,{left:0,ease:j},0)),f.add(function(){var a=g.outputA;g.outputA=g.outputB,g.outputB=a,g.outputB.detach(),e(n),n=[],i=!1})}}}(),function(){function a(a,b,c){var e=document.createElement("div");e.className="word",e.innerHTML=a;var f=$(e);return f.toggleClass("activated",c),b?d.container.prepend(f):d.container.append(f),c||f.on("click",function(){g.toPage(a)}),f}var b,c,d={},e=9,f=4,g=window.Entries.List.PageIndex={init:function(a){d.container=a,d.btnPrevPage=d.container.find(".word-prev-page").on("click",function(){g.toPrevPage()}).detach(),d.btnNextPage=d.container.find(".word-next-page").on("click",function(){g.toNextPage()}).detach(),d.btnPrevBlock=d.container.find(".word-prev-block").on("click",function(){g.toPrevBlock()}).detach(),d.btnNextBlock=d.container.find(".word-next-block").on("click",function(){g.toNextBlock()}).detach(),g.clear()},toPrevPage:function(){g.toPage(c-1)},toNextPage:function(){g.toPage(c+1)},toPrevBlock:function(){g.toPage(c-e)},toNextBlock:function(){g.toPage(c+e)},toPage:function(a){var d=c;a<1&&(a=1),a>b&&(a=b),Entries.List.doSearch(a-1,!1,d-1)},update:function(h,i){if(i<1||i>h)return console.log("illegal params, numPages: "+h+", pageIndex: "+i),void g.clear();g.clear(),b=h,c=i;var j,k,l=0,m=0;for(a(i,!1,!0),i++,l++;m<f&&i<=b;)a(i,!1,!1),i++,l++,m++;for(k=i-1,m=0,i=c-1;m<f&&i>=1;)a(i,!0,!1),i--,l++,m++;if(j=i+1,k<=b){for(i=k+1;l<e&&i<=b;)a(i,!1,!1),i++,l++;k=i-1}if(j>=1){for(i=j-1;l<e&&i>=1;)a(i,!0,!1),i--,l++;j=i+1}var n=!1,o=!1;1!==j&&d.container.prepend(d.btnPrevBlock),1!==c&&(d.container.prepend(d.btnPrevPage),n=!0),k!==b&&d.container.append(d.btnNextBlock),c!==b&&(d.container.append(d.btnNextPage),o=!0),Entries.List.updateArrows(n,o)},clear:function(){d.btnPrevPage.detach(),d.btnNextPage.detach(),d.btnPrevBlock.detach(),d.btnNextBlock.detach(),d.container.empty()}}}(),function(){function a(b,c,d,e,f){var g=this.$dom=a.$sample.clone();if(g.find(".text-num-votes").text("累積票數："+c),g.find(".text-author").text("作者："+d),g.find(".text-serial").text("編號："+(parseInt(e)+1e4).toString().substr(1)),f){var h=document.createElement("img");$(h).attr("width","100%").attr("height","100%"),h.onload=function(){g.find(".thumb").append(h),TweenMax.from(h,.5,{opacity:0})},h.src=f}b.append(g)}window.Entries.List.Thumb=a,a.$sample=null,a.prototype={$dom:null,destroy:function(){this.$dom.detach()}}}(),function(){function a(a){d={select:k.Select,filling:k.Filling,form:CommonForm},$("#invisible-container").append(a[0].dom),e.container=$("#fill"),k.Select.init(e.container.find(".select-step")),k.Filling.init(e.container.find(".filling-step")),k.Examples.init($("#fill-examples")),k.Success.init($("#fill-success")),k.ShareSuccess.init($("#fill-share-success")),e.container.detach()}function b(a){$("#scene-container").append(e.container),k.resize(),g=0==Main.settings.viewport.index?"filling":h,d[g].show(0,a)}function c(a){k.Examples.hide(),d[g].hide(0,function(){e.container.detach(),a.apply()})}var d,e={},f=!1,g="select",h=g,i=null,j=null,k=window.Fill={stageIn:function(c,d){function e(a){a&&c.cbContentLoaded&&c.cbContentLoaded.call(),b(d)}function g(b){var c=[{url:"_fill.html",startWeight:0,weight:82,dom:null}];SceneHandler.loadTemplate(null,c,function(){j=document.createElement("img"),j.onload=function(){Loading.progress(100),a(c),f=!0,Loading.hide(),b.apply(null)},j.src="./misc/share.fill.raw.jpg"},!0)}f?e():g(e)},stageOut:function(a,b){c(b)},toStep:function(a){a!=g&&(d[g].hide(),g=a,"form"==g?(e.container.detach(),CommonForm.setMode("fill")):$("#scene-container").append(e.container),d[g].show())},setSendingIllust:function(a){i=a},getSendingCanvas:function(){if(i){var a={x:322,y:197,width:544,height:406},b=i.getOutputCanvas(),c=Helper.imageToCanvas(j,j.width,j.height);return c.getContext("2d").drawImage(b,a.x,a.y,a.width,a.height),c}return null},getIllustIndex:function(){return i?i.index:null},getDescription:function(){return i?i.getInputString():null},resize:function(){f&&d[g]&&d[g].resize&&d[g].resize()}}}(),function(){function a(){c&&(c.kill(),c=null);var a,b,e,i,j=Main.settings.viewport,k=-(h-1)*g;if(0==j.index)for(a=1;a<=f;a++)b=d["item-"+a],e=g*(a-1)+k+"%",i=a==h?1:.9,TweenMax.set(b,{marginLeft:e,scale:i});else for(a=1;a<=f;a++)b=d["item-"+a],TweenMax.set(b,{marginLeft:0,scale:1})}function b(a){if(a!=h){h=a;if(0==Main.settings.viewport.index){c&&c.kill();for(var b,e,i,j,k=-(h-1)*g,l=1;l<=f;l++)j=d["item-"+l],b=g*(l-1)+k,e=b+"%",i=l==h?1:.9,c=new TimelineMax,c.to(j,.5,{marginLeft:e,scale:i},0)}}}var c,d={},e=!0,f=4,g=475,h=1;window.Fill.Select={init:function(a){function c(a){(d["item-"+a]=d.container.find(".item-"+a)).on(_CLICK_,function(){1==Main.settings.viewport.index?e(a):h==a?e(a):b(a)})}function e(a){Fill.Filling.toIndex(a-1,!1,!0),Fill.toStep("filling")}d.container=a,d.parent=a.parent();for(var g=1;g<=f;g++)c(g);d.container.detach()},show:function(a,b){if(e){e=!1,d.parent.append(d.container),void 0===a&&(a=0);var c=new TimelineMax;c.set(d.container,{autoAlpha:0,marginTop:50}),c.to(d.container,.4,{autoAlpha:1,marginTop:0},a),c.add(function(){b&&b.apply()})}},hide:function(a,b){if(!e){e=!0;var c=new TimelineMax;c.to(d.container,.4,{autoAlpha:0},a),c.add(function(){d.container.detach(),b&&b.apply()})}},resize:function(){a()}}}(),function(){var a={},b=!0,c=4,d=4,e=null,f=[],g=!1,h=!1,i={0:{illustGap:20,illustWidth:464},1:{illustGap:20,illustWidth:464}},j=window.Fill.Filling={isLocking:!1,init:function(b){a.container=b,a.parent=b.parent(),a.workContainer=a.container.find(".works");for(var d=1;d<=c;d++){(f[d-1]=new Fill.Illust(d,a.container.find(".work-"+d))).$container.detach()}a.btnToPrev=a.container.find(".arrow-left").on(_CLICK_,function(){j.toPrev()}),a.btnToNext=a.container.find(".arrow-right").on(_CLICK_,function(){j.toNext()}),a.btnToSample=a.container.find(".btn-to-sample").on(_CLICK_,function(){Fill.Examples.show()}),a.btnSend=a.container.find(".btn-send").on("click",function(){h?g?(Fill.setSendingIllust(f[e]),Fill.toStep("form")):alert("您必須同意我們的活動辦法"):alert("請輸入填空內容")}),a.ruleCheckbox=a.container.find("#filling-checkbox").on("change",function(){j.update()}),j.toIndex(0),a.container.detach()},toNext:function(){var a=e+1;a>=c&&(a=0),j.toIndex(a,!1)},toPrev:function(){var a=e-1;a<0&&(a=c-1),j.toIndex(a,!0)},toIndex:function(b,c,d){if(!j.isLocking&&e!==b){var g=e;e=b;var h,k,l,m,n=Main.settings.viewport,o=i[n.index],p=o.illustWidth+o.illustGap;if(null!==g&&(k=f[g]),l=f[e],d||null===g)return l.$container.css("left",0),a.workContainer.append(l.$container),k&&(k.close(),k.$container.detach()),l.open(),void j.update();a.workContainer.append(l.$container),c?(l.$container.css("left",-p),m=p):(l.$container.css("left",p),m=-p),j.isLocking=!0,k.close(),j.update(),h=new TimelineMax,h.to(k.$container,.5,{left:m}),h.to(l.$container,.5,{left:0},0),h.add(function(){l.open(),k.$container.detach(),j.isLocking=!1})}},update:function(){var b=f[e];h=b.getInputString().length>=d,g=a.ruleCheckbox[0].checked;var c=h&&g;a.btnSend.toggleClass("disactivated",!c)},show:function(c,d){if(b){b=!1,a.parent.append(a.container),void 0===c&&(c=0);var e=new TimelineMax;e.set(a.container,{autoAlpha:0,marginTop:50}),e.to(a.container,.4,{autoAlpha:1,marginTop:0},c),e.add(function(){d&&d.apply()})}},hide:function(c,d){if(!b){b=!0;var e=new TimelineMax;e.to(a.container,.4,{autoAlpha:0},c),e.add(function(){a.container.detach(),d&&d.apply()})}}}}(),function(){window.Fill.Illust=function(a,b){this.init(a,b)},String.prototype.replaceAll=function(a,b){return this.replace(new RegExp(a,"g"),b)},window.Fill.Illust.prototype={index:null,illustratorIndex:null,image:null,$container:null,$input:null,$inputBound:null,$btnSend:null,textCanvas:null,textCtx:null,_oldInputText:"",_isOpen:!1,_defaultText:"請任選以下詞語來練肖話:有才、厭世、耍廢、正妹、鄉民、天真、生火、神人。",init:function(a,b){var c=this;this.index=a,this.$container=b,this.$textHolder=b.find(".text-holder"),this.$image=b.find(".raw-image"),this.image=this.$image[0],this.$input=b.find(".input-field").on("input",function(){c.textToCanvas(),Fill.Filling.update()}),this.$container.on("click",function(a){a.target!=c.$input[0]&&c.$input.focus()}),this._oldInputText=this.$input.val(),this.$input.val(""),c.textToCanvas()},open:function(){this._isOpen||(this._isOpen=!0,this.$container.toggleClass("open-mode",!0),this.$input.focus(),this.textToCanvas())},close:function(){this._isOpen&&(this._isOpen=!1,this.$container.toggleClass("open-mode",!1))},createTextCanvas:function(){var a=this.$container.find(".text-canvas");this.textCanvas=a[0],this.textCanvas.startLeft=this.textCanvas.finalLeft=parseInt(a.css("left")),this.textCanvas.startTop=this.textCanvas.finalTop=parseInt(a.css("top")),a[0].width=parseInt(a.css("width")),a[0].height=parseInt(a.css("height")),this.textCtx=a[0].getContext("2d")},textToCanvas:function(){function a(a,b,c){k.fillText(a,b,c)}var b=this.$input;this.textCtx||this.createTextCanvas();var c=this.$input.val(),d=this.textCanvas.width,e=(this.textCanvas.height,parseInt(this.$textHolder.css("font-size"))),f=parseInt(this.$textHolder.css("line-height")),g=b.css("font-family");if(0==c.length?(this.textCtx.fillStyle="rgba(0,0,0,.3)",c=this._defaultText):this.textCtx.fillStyle="#000000",this._oldText!==c){this._oldText=c,this.textCtx.clearRect(0,0,this.textCanvas.width,this.textCanvas.height);var h,i,j,k=this.textCtx;k.font=e+"px "+g,i=0,j=e;var l="";for(h=0;h<c.length;h++){var m=c[h].charCodeAt(0);l+=c[h],this.$textHolder[0].innerHTML=l.replaceAll(" ","&nbsp;");var n=this.$textHolder.width();10==m?(l=l.substr(0,l.length-1),a(l,i,j),l="",i=0,j+=f):n>d&&(h--,l=l.substr(0,l.length-1),a(l,i,j),l="",i=0,j+=f)}l.length>0&&a(l,i,j)}},getInputString:function(){var a=this.$input.val();return a===this._defaultText&&(a=""),a},getOutputCanvas:function(){var a=this.image.width,b=this.image.height,c=document.createElement("canvas");c.width=a,c.height=b;var d=c.getContext("2d");return d.drawImage(this.image,0,0,a,b),d.drawImage(this.textCanvas,this.textCanvas.finalLeft,this.textCanvas.finalTop),c}}}(),function(){var a={},b=2,c=null,d=!0,e={0:{illustGap:20,illustWidth:468},1:{illustGap:20,illustWidth:468}},f=window.Fill.Examples={isLocking:!1,init:function(c){a.container=c,a.parent=$("body"),a.content=a.container.find(".content"),a.sampleContainer=a.container.find(".example-container"),a.btnToPrev=a.container.find(".arrow-left").on(_CLICK_,function(){f.toPrev()}),a.btnToNext=a.container.find(".arrow-right").on(_CLICK_,function(){f.toNext()}),a.sampleList=[];for(var d=1;d<=b;d++){var e=a.sampleList[d-1]=a.container.find(".example-"+d);e.find(".btn-close").on(_CLICK_,function(){f.hide()}),e.detach()}f.toIndex(0),a.container.detach()},toNext:function(){var a=c+1;a>=b&&(a=0),f.toIndex(a,!1)},toPrev:function(){var a=c-1;a<0&&(a=b-1),f.toIndex(a,!0)},toIndex:function(b,d){if(!f.isLocking){var g=c;c=b;var h,i,j;j=a.sampleList[c];var k,l=Main.settings.viewport,m=e[l.index],n=m.illustWidth+m.illustGap;if(null===g)return j=a.sampleList[c],j.css("left",0),void a.sampleContainer.append(j);i=a.sampleList[g],a.sampleContainer.append(j),d?(j.css("left",-n),k=n):(j.css("left",n),k=-n),f.isLocking=!0,h=new TimelineMax,h.to(i,.5,{left:k}),h.to(j,.5,{left:0},0),h.add(function(){i.detach(),f.isLocking=!1})}},show:function(b,c){if(d){d=!1,a.parent.append(a.container),void 0===b&&(b=0);var e=new TimelineMax;e.set(a.container,{autoAlpha:0}),e.to(a.container,.4,{autoAlpha:1},b),e.set(a.content,{marginTop:100},0),e.to(a.content,.4,{marginTop:0},b),e.add(function(){c&&c.apply()})}},hide:function(b,c){if(!d){d=!0;var e=new TimelineMax;e.to(a.container,.2,{autoAlpha:0},b),e.add(function(){a.container.detach(),c&&c.apply()})}}}}(),function(){var a,b={},c=!0,d=window.Fill.Success={init:function(c){b.container=c,b.content=b.container.find(".content"),b.parent=$("body"),b.btnClose=b.container.find(".btn-close").on("click",function(){d.hide(),SceneHandler.toHash("/Entries")}),b.btnShare=b.container.find(".btn-share").on("click",function(){FB.ui({method:"feed",display:"iframe",link:Utility.getPath(),picture:a+"?v="+(new Date).getTime(),title:"輕鬆小品 全台輕鬆練肖畫募集大賽！",description:"為紓解大眾生活壓力、促進國民身心健康、培養輕鬆幽默的處世態度，輕鬆小品邀你一起輕鬆練肖畫/話、輕鬆拿獎金，還有機會登上包裝供全民欣賞喔～"},function(a){a&&a.post_id&&(d.hide(),Fill.ShareSuccess.show())})}),b.container.detach()},setShareImageUrl:function(b){a=b},show:function(a,d){if(c){c=!1,b.parent.append(b.container),void 0===a&&(a=0);var e=new TimelineMax;e.set(b.container,{autoAlpha:0}),e.to(b.container,.4,{autoAlpha:1},a),e.set(b.content,{marginTop:-30},0),e.to(b.content,.4,{marginTop:-130},a),e.add(function(){d&&d.apply()})}},hide:function(a,d){if(!c){c=!0;var e=new TimelineMax;e.to(b.container,.2,{autoAlpha:0},a),e.add(function(){b.container.detach(),d&&d.apply()})}}}}(),function(){var a={},b=!0,c=window.Fill.ShareSuccess={init:function(b){a.container=b,a.content=a.container.find(".content"),a.parent=$("body"),a.btnClose=a.container.find(".btn-close").on("click",function(){c.hide(),SceneHandler.toHash("/Entries")}),a.btnToNext=a.container.find(".btn-to-next").on("click",function(){c.hide(),SceneHandler.toHash("/Participate")}),a.container.detach()},show:function(c,d){if(b){b=!1,a.parent.append(a.container),void 0===c&&(c=0);var e=new TimelineMax;e.set(a.container,{autoAlpha:0}),e.to(a.container,.4,{autoAlpha:1},c),e.set(a.content,{marginTop:-30},0),e.to(a.content,.4,{marginTop:-130},c),e.add(function(){d&&d.apply()})}},hide:function(c,d){if(!b){b=!0;var e=new TimelineMax;e.to(a.container,.4,{autoAlpha:0},c),e.add(function(){a.container.detach(),d&&d.apply()})}}}}(),function(){function a(a){$("#invisible-container").append(a[0].dom),e.container=$("#rule"),e.contentContainer=e.container.find(".content-container"),d=new SimpleScroller(e.contentContainer[0],null,0,Modernizr.touchevents).update(!0),e.btnClose=e.container.find(".btn-close").on("click",function(){var a=SceneHandler.getLastHash();a?SceneHandler.toHash(a):SceneHandler.toHash("/Index")}),e.container.detach()}function b(a){$("#scene-container").append(e.container),g.resize();var b=new TimelineMax;b.set(e.container,{autoAlpha:0,marginTop:-300}),b.to(e.container,.3,{autoAlpha:1},0),b.to(e.container,.6,{marginTop:0,ease:Back.easeOut},0),b.add(function(){a.apply()})}function c(a){var b=new TimelineMax;b.to(e.container,.4,{autoAlpha:0,marginTop:-200}),b.add(function(){e.container.detach(),a.apply()})}var d,e={},f=!1,g=window.Rule={stageIn:function(c,d){function e(a){a&&c.cbContentLoaded&&c.cbContentLoaded.call(),b(d)}function g(b){var c=[{url:"_rule.html",startWeight:0,weight:100,dom:null}];SceneHandler.loadTemplate(null,c,function(){a(c),f=!0,b.apply(null)},0)}f?e():g(e)},stageOut:function(a,b){c(b)},resize:function(){if(f){var a=Main.settings.viewport;if(a.changed){var b=0==a.index?101:44,c=e.contentContainer.height(),g=e.contentContainer.width();d.containerSize(null,c).scrollBound(g+10,3,0,c-b).update(!0)}}}}}();